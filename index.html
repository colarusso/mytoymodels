<!DOCTYPE HTML>
<HTMl>
<HEAD>

	<TITLE>My Toy Models</TITLE>
	<meta http-equiv="Content-type" content="text/html;charset=UTF-8"/>

	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<link rel="apple-touch-icon" href="images/icon.png"/>

	<meta property="og:site_name" content="My Toy Models"/>
	<meta property="og:type" content="website"/>
	<meta property="og:title" content="My Toy Models"/>
	<meta property="og:description" content="If you‚Äôve ever wanted to ‚Äúrun a study‚Äù on some aspect of your personal life, this site is for you. It lets you ‚Äúscience the heck‚Äù out of your pet hypotheses‚Äîbuilding simple predictive models (regressions) around your data."/>
	
	<link rel="stylesheet" type="text/css" href="css/main.css?v=2023-05-10.13:09">
	<link rel="stylesheet" type="text/css" href="css/spin.css?v=2023-05-10.13:09">

	<script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>
	
	<script type="module" src="https://findmycite.org/js/spin.min.js"></script>
	<script src="js/interactions.js?v=2023-05-10.13:09"></script>
	
	<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
	<script id="MathJax-script" async
			src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

	<script src="js/model_lib.js?v=2023-05-10.13:09"></script>

	<script src="https://rawgit.com/chen0040/js-regression/master/build/jsregression.min.js" type="application/javascript"></script>

	<!--
	<script language="javascript" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.js"></script>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/codemirror.min.css"></link>
	<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/6.65.7/theme/abbott.min.css"></link>
	-->

</HEAD>

<BODY BGCOLOR="#ffffff" BACKGROUND="" MARGINWIDTH="0" MARGINHEIGHT="0">
<div id="menu_bar" class="menu_bar">
  <a id="models_link" href="javascript:void('');" onClick="show_list();">Models</a>
  <input id="upload" type="file"/> 
  &nbsp;&nbsp;<a id="new_mod" href="javascript:void('');" onClick="load_state(1);make_new();">New</a>
  &nbsp;&nbsp;<a id="upload_link" href="javascript:void('');" onClick="upload_file(1);">Load</a>
  &nbsp;&nbsp;<a id="down_mod" href="javascript:void('');" onClick="save_model();">Download</a>
  <div style="float:right">
	<a id="run_mod" href="javascript:void('');" onClick="show_model();">Run</a>
	<a id="edit_mod" href="javascript:void('');" onClick="show_edit();">Edit</a>
  </div>
</div>

<div id="about" class="about">
	<h2>Your Toy Models</h2>
	<p>
	If you‚Äôve ever wanted to ‚Äúrun a study‚Äù on some aspect of your personal life, this site is for you. It lets you "science the heck" out of your pet hypotheses‚Äîbuilding simple predictive models (<a href="https://en.wikipedia.org/wiki/Regression_analysis" target="_blank" class="body_links">regressions</a>) around your data. All the number crunching runs in your browser. So your data stays on your device (unless you activly download and share it, which I tried to make easy).  
	</p>
	<img src="images/colarusso.jpg" style="border-radius: 50%;float:left;width:50px;margin:0 15px 5px 0;"/>
	<p>
	I <a href="https://www.codingthelaw.org" target="_blank">teach law students</a> about data, machine learning, and ‚ÄúAI.‚Äù I made this tool so they could get a feel for <i>narrow AI</i> (machine learning) by building their own. As Richard Feynman observed, ‚Äúthat which I cannot create, I do not understand.‚Äù That being said, I don‚Äôt expect my students to become statisticians or data scientists. Rather, I want them to learn enough to understand the realm of the possible and call BS when needed. To that end, this site lets you create your own <a href="https://en.wikipedia.org/wiki/Toy_model" target="_blank">toy models</a>, intentional simplifications that help folks explore the dynamics of a situation. That being said, keep in mind the tools provided here embody that dangerous mix of power and ease of use. Please consult a statistics text before assuming you know what they are telling you. ;)
	</p>
	<p>I haven't embedded analytics or tracking here, and all your data stays on your device/ My hope is this will free you to experiment honestly. But it means I don't know if folks are even using this tool unless they tell me. So, I'd apprechiate you telling what you're up to. You can find me <a href="" target="_blank">@Colarusso@mastodon.social</a> or use <a href="" target="_blank">this feedback form</a>. Want to look at the code? Check out <a href="" target="_blank">this GitHub repo</a>.</p>

	<p><a href="https://github.com/colarusso/mytoymodels#documenation" target="_blank" class="body_links">the documentation</a></p>

	<hr style="border: 0px;border-top: 1px solid #555;margin:25px 0 15px 0;">
	<div class="button_container">
		<a href="javascript:void('')" onClick="make_new();" class="button">New Model</a>
	</div>
</div>

<div id="tos" class="tos"><h2>Terms of Service</h2></div>
<div id="list_screen"><div id="list"></div></div>
<div id="lib_screen"><div id="list"></div></div>

<div id="new_model_screen" class="new_model_screen">
	<div id="new_model" class="new_model">
		<div class="l_img_embed" style="max-width:400px;">
			<img src="images/boxquote.png" alt="'All models are wrong, but some are useful.' - George Box" width="100%"/>
			<div class="caption">Maps are models; they don't show everything. That's okay as long as you don't confuse the map for the territory.</div>
		</div>
		A model providing an answer <a href="https://www.codingthelaw.org/Fall_2022/level/4/#intro_vid" target="_blank" class="body_links">isn't a guarentee</a> that it's "right." <a href="https://en.wikipedia.org/wiki/Toy_model" target="_blank" class="body_links">Toy models</a> are intentional simplifications meant to help folks understand how things relate to eachother. This understanding, however, only comes through play. You need to know your subject matter and get your hands dirty wadding through the data&mdash;tweaking this and fiddling with that. 
		<p>Maybe you'll create a sleep log and figure out when it's safe to have that last coffee or discover some feature you didn't think was important really is the best predictor of your mood but only if you take the time to explore possible features and collect lots of data. Even then, remember, correlation isn't causation; <a href="https://www.kdnuggets.com/2017/02/hill-data-scientist-xkcd-story.html" target="_blank" class="body_links">consider the context</a>. And beware, for if you torture the data long enough, it will <a href="https://en.wikipedia.org/wiki/Data_dredging" target="_blank" class="body_links">confess to anything</a>. <!--For more on model making, check out this short lecture.--></p>
		<p>Now go ahead, make a model.</p>
		<div class="button_container">
			<a href="javascript:void('')" onClick="show_lib();" class="button">From Library</a>
			<a href="javascript:void('')" onClick="upload_file();" class="button">From a File</a>
			<a href="javascript:void('')" onClick="show_build();" class="button">From Scratch</a>
		</div>
	</div>
</div>

<div id="build_new" class="build_new">
	<h2>Build A Model From Scratch</h2>
	<div id="input_question_type">
		<p>lorum ipsum</p>
		<h3>What do you want to do?</h3>
			<a href="javascript:void('')" onClick="new_model_type('continuous')" class="button">A Numeric Value</a>
		<a href="javascript:void('')" onClick="new_model_type('categorical')" class="button">Yes or No (odds of Yes)</a>
	</div>
	<div id="input_question">
		<p>
			<p>lorum ipsum</p>
			<h3>Your Question</h3>
			<input id="new_json_question">
			<p>lorum ipsum</p>
			<h3>Note (optional)</h3>
			<input id="new_json_note">
		</p>
		<hr style="border: 0px;border-top: 1px solid #555;margin:25px 0 15px 0;">
		<a href="javascript:void('')" onClick="new_model_feature()" class="button">Add Features</a>
	</div>
	<div id="input_features">
		<p>
			<p>lorum ipsum</p>
			<h3>Feature Name</h3>
			<input id="new_json_feature_name">
			<p>lorum ipsum</p>
			<h3>More (optional)</h3>
			<input id="new_json_feature_more">
		</p>
		<p>
			<p>lorum ipsum</p>
			<h3>Type of Feature</h3>
			<select id="choose_type" oninput="new_model_feature_type(this.value)">
				<option value="choose">Choose One</option>
				<option value="continuous">Continuous</option>
				<option value="categorical">Categorical</option>
			</select>
		</p>
		<div id="feature_units">
			<p>lorum ipsum</p>
			<h3>Units</h3>
			<input id="new_json_feature_units">
		</div>
		<div id="feature_options">
			<p>lorum ipsum</p>
			<h3>Options</h3>
			<p id="feature_options_list">
				<input id="new_json_feature_option_0">	
			</p>
			<p id="remove_option" >
				<input type="button" onClick="remove_last()" style="background:rgb(255, 100, 100)" value="Remove Last"/>
			</p><p>
				<input type="button" onClick="add_feature_option()" value="Add Option"/>
			</p>
		</div>
		<hr style="border: 0px;border-top: 1px solid #555;margin:25px 0 15px 0;">
		<div id="feature_next">
			<p>
				<a href="javascript:void('')" onClick="new_model_feature(1)" class="button">Add Another Feature</a>		
				<a href="javascript:void('')" onClick="finalize_model()" class="button">Finalize Model</a>		
			</p>
		</div>
	</div>
	<div id="forget">
		<a href="javascript:void('')" onClick="make_new()" class="button" style="background-color:red">Forget This Model</a>
	</div>
</div>

<script>
	var tmp = {}
	function new_model_type(type) {
		tmp = {}
		tmp["type"] = type;
		new_model_question();
		window.scrollTo(0,0);
		$('#new_json_question').focus();
	}
	function new_model_question() {
		$('#forget').show();
		$('#input_question_type').hide();
		$('#input_question').show();
		window.scrollTo(0,0);
		$('#new_json_feature_name').focus();	
		console.log("Building model...")
		console.log(tmp)
	}
	function new_model_feature(mode=0) {
		$('#input_question_type').hide();
		$('#input_question').hide();
		$('#input_features').show();
		$('#feature_units').hide();
		$('#feature_options').hide();
		$('#feature_next').hide();
		$("#choose_type").val("choose");
		window.scrollTo(0,0);
		$('#new_json_feature_name').focus();	
		if (mode==0) {	
			tmp["question"] = $('#new_json_feature_name').val();
			if ($('#new_json_question').val().trim()!="") {
				tmp["description"] = $('#new_json_question_note').val();
			}
			tmp["features"] = []
		} else if (mode==1) {
			feature = {}
			feature["name"] = $('#new_json_feature_name').val();
			if ($('#new_json_feature_more').val().trim()!="") {
				feature["description"] = $('#new_json_feature_more').val();
			}
			if ($('#choose_type').val()=="continuous") {
				feature["type"] = "continuous"
			} else if ($('#choose_type').val()=="categorical") {
				feature["type"] = "categorical"
			}
			tmp["features"].push(feature)
		}
		console.log("Building model...")
		console.log(tmp)
	}
	function new_model_feature_type(type) {
		if (type=="choose"){
			$('#feature_units').hide();
			$('#feature_options').hide();
			$('#feature_next').hide();
		} else if (type=="continuous"){
			$('#feature_units').show();
			$('#feature_options').hide();
			$('#feature_next').show();
		} else if (type=="categorical") {
			$('#feature_options_list').empty();
			$('#feature_options_list').append(`<input>`)
			$('#remove_option').hide();
			$('#feature_units').hide();
			$('#feature_options').show();
			$('#feature_next').show();
			dark_mode();
			$('#new_json_feature_option_0').focus();		
		}
		console.log("Building model...")
		console.log(tmp)
	}
	function add_feature_option() {
		$('#feature_options_list').append(`<input id="new_json_feature_option_0">`)
		$('#new_json_feature_option_0').focus();		
		$('#remove_option').show();
		dark_mode();
	}
	function remove_last() {
		//
	}
	function finalize_model() {
		console.log("Building model...")
		console.log(tmp)
		show_list();
	}
</script>

<div id="run">
	<div id="prediction" class="prediction">
		<h1 id="question_text">Loading...</h1>
		<h2 id="prediction_text">--</h2>
		<p>
			Based on <span id="n_entires"><i>n</i></span> <a href="javascript:void('');" onClick="arr2csv()">observations</a>
		</p>
	</div>
	<div id="features_wrapper">  
		<div id="features"></div>			
	</div>
</div>

<div id="ground_truth_screen" class="ground_truth_screen"></div>
<div id="training" class="training"><span id="spinner_here">&nbsp;</span></div>

<div id="edit_screen" class="edit_screen">
	<div id="edit" class="edit">
		<p>
			You can experiemnt with edits to your model below or read <a href="https://github.com/colarusso/mytoymodels#documenation" target="_blank" class="body_links">the documentation</a>.<sup>&dagger;</sup>
		</p>

		<textarea id="model_json" style="width:100%;height:55vh;" oninput="changes=1"></textarea>

		<div id="wrap_box" style="display: block;">
		<span style="float:right"><a href="javascript:void('');" onClick="arr2csv();" class="body_links">observations (CSV)</a></span>
		<label><input type="checkbox" id="wrap" name="wrap" value="1" onchange="toggle_wrap('');"> word wrap</label> 
		</div>
		<div class="button_container">
			<a href="javascript:void('')" onClick="save_changes();" class="button">Save Changes</a>
			<a href="javascript:void('')" onClick="save_and_train(1);" class="button">Save &amp; Train</a>
			<a href="javascript:void('')" onClick="delete_mod();" class="button" style="background:#c61c1c">Delete</a>
		</div>
		<div style="float:left;width:100%;margin:5px 0 70px 0;">
		<sup>&dagger;</sup> FWIW, the documenation discusses how to add advanced features like interaction terms.
		</div>
	</div>
</div>


<div id="footer" class="footer">
	<a id="about" href="javascript:void('');" onClick="show_about();">About</a> | 
	<a id="tos" href="javascript:void('')" onClick="show_tos()">Terms</a> | 
	<a id="feedback" href="https://docs.google.com/forms/d/e/1FAIpQLSfNN9v_A_wtILTMKuHIKFcRmMrq3CQSC1qgMZYCIlTGdBJnmA/viewform" target="_blank">Feedback</a>
	<span style="float: right;"><a id="mode" href="javascript:void('')" onClick="dark_mode(1)" style="text-decoration: none;">üåó</a></span>
</div>

</BODY>

<script type="text/javascript">

if (!localStorage.questions) {
	localStorage.questions = "[]";
}

function rethinkWindowSize() {
	$('#features_wrapper').css('top',($('#prediction').height()+40)+'px');
	$('#features_wrapper').scrollTop(0);
}

window.onresize = rethinkWindowSize;

$(window).on("orientationchange", function( event ) {
	rethinkWindowSize();
});

function dark_mode(change=null){
	if (localStorage.dark_mode) {
		m = localStorage.dark_mode
	} else {
		m = 0;
		localStorage.dark_mode = m;
	}
	if (change) {
		m = 1-m;
	}
	if(m==1){
		$('body').css("background","black"); 
		$('body').css("color","white");
		//$('about a:link').css("color","#0a9de7");
		$("#menu_bar").attr('class', 'menu_bar_dark');
		$("#list").attr('class', 'list_dark');
		$("div[class='list_item']").attr('class', 'list_item_dark');
		$("#prediction").attr('class', 'prediction_dark');
		$("a[class='body_links']").attr('class', 'body_links_dark');
		$("#footer").attr('class', 'footer_dark');
		$('#mode').html("üí°"); 
		$("input,textarea,select,.regression").css('opacity', 0.75) 
		localStorage.dark_mode = 1;
	} else {
		$('body').css("background","white"); 
		$('body').css("color","black"); 
		//$('body a:link').css("color","blue");
		$("#menu_bar").attr('class', 'menu_bar');
		$("#list").attr('class', 'list');
		$("div[class='list_item_dark']").attr('class', 'list_item');
		$("#prediction").attr('class', 'prediction');
		$("a[class='body_links_dark']").attr('class', 'body_links');
		$("#footer").attr('class', 'footer');
		$('#mode').html("üåó"); 
		$("input,textarea,select,.regression").css('opacity', 1) 
		localStorage.dark_mode = 0;
	}
}

function show_about(){
	console.log("Show About Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "About My Toy Models";
		$('#about').show();
		$('#tos').hide();
		$('#list_screen').hide();
		$('#new_model_screen').hide();
		$('#build_new').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "about";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);
	}
}

function show_tos(){
	console.log("Show ToS Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "Terms of Service";
		$('#about').hide();
		$('#tos').show();
		$('#list_screen').hide();
		$('#new_model_screen').hide();
		$('#build_new').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "about";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);
	}
}


function show_list() {
	console.log("Show List Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "My Toy Models";
		$('#list').empty();
		i = 0;
		for (question in JSON.parse(localStorage.questions)) {
			$('#list').append(`<div class="list_item" onclick="localStorage.removeItem('feature_values');load_model(`+i+`);show_model(`+i+`);"><div style="float:right;height:100%;padding:0 0px 15px 15px;">></div>`+JSON.parse(localStorage.questions)[question]["question"]+`</div>`);
			i+=1;
		}
		$('#list').append(`<div class="button_container" style="padding:0 15px;"><a href="javascript:void('')" onClick="make_new();" class="button">New Model</a>
		<p><i>Note: To remove a model, navigate to the model's "Edit" screen, then choose "Delete."</i></p></div>	`);

		$('#about').hide();
		$('#tos').hide();
		$('#list_screen').show();
		$('#new_model_screen').hide();
		$('#build_new').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "list";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'none');
		$('#models_link').css('font-weight', 'bold');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);

		mem_usage();
	}
}

function show_lib() {
	console.log("Show Library Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "Library of Toy Models";
		$('#list').empty();
		i = 0;
		for (question in library) {
			$('#list').append(`<div class="list_item" onclick="load_lib_model(`+i+`);show_list();"><div style="float:right;height:100%;padding:0 0px 15px 15px;"><span class="plus">+</span></div>Add <b><i>`+library[question]["question"]+`</i></b> to <i>Models</i></div>`);
			i+=1;
		}
		$('#list').append(`<div class="button_container" style="padding:0 15px;"><a href="javascript:void('')" onClick="make_new();" class="button">New Model</a></div>`);

		$('#about').hide();
		$('#tos').hide();
		$('#list_screen').show();
		$('#new_model_screen').hide();
		$('#build_new').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "lib";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);
	}
}

function make_new() {
	console.log("Show Make New Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "Make New Model";
		$('#about').hide();
		$('#tos').hide();
		$('#list_screen').hide();
		$('#new_model_screen').show();
		$('#build_new').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "new";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').hide();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);
	}
}


function show_build(){
	console.log("Show Build New Screen")
	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		document.title = "Build Model From Scratch";
		$('#about').hide();
		$('#tos').hide();
		$('#list_screen').hide();
		$('#new_model_screen').hide();
		$('#build_new').show();
		$('#input_question_type').show();
		$('#input_question').hide();
		$('#input_features').hide();
		$('#forget').hide();
		$('#run').hide();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "new";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').hide();
		dark_mode();
		window.scrollTo(0,0);
	}
}


function show_model() {
	console.log("Show Model Screen")

	model = JSON.parse(localStorage.questions)[0]
	features = model["features"];
	feature_list = features.map(features => snake_case(features.name));
	feature_list.push("note");
	coefficients = model["coefficients"];

	if ( (localStorage.feature_values) && (feature_list.sort().join('/')==Object.keys(JSON.parse(localStorage.feature_values)).sort().join('/')) ) {
		feature_values = JSON.parse(localStorage.feature_values);
		console.log("Load saved feature values: ",feature_values)
	} else {
		var feature_values = {"note":""};
		for (feature in feature_list) {
			features.forEach((element,index) => {
				if (feature_list[feature]==snake_case(element["name"])) {
					if (element["type"]=="continuous") {
						feature_values[snake_case(feature_list[feature])] = element["mean"];
					} else if (element["type"]=="categorical") {
						feature_values[snake_case(feature_list[feature])] = element["categories"][ element["weights"].indexOf(Math.max(...element["weights"])) ];
					}
				}
			})
		}
		localStorage.feature_values = JSON.stringify(feature_values);
		console.log("Load default feature values: ",feature_values)
	}

	html = '<h2>Inputs/Features</h2>';
	features.forEach((element,index) => {
			html += `<div class="feature">`;
			if (element["type"]=="continuous") {
				html += `<b>`+(index+1)+`) `+element["name"]+`:</b>	<span id="`+snake_case(element["name"])+`">`+feature_values[snake_case(element["name"])]+`</span> (<span id="`+snake_case(element["name"])+`_units">`+element["units"]+`</span>)<p>`;
				html += `<input type="range" min="`+element["lower"]+`" max="`+element["upper"]+`" value="`+feature_values[snake_case(element["name"])]+`" class="slider" id="myRange" class="slider" oninput="$('#`+snake_case(element["name"])+`').html(this.value);run_model();">`;
			} else if (element["type"]=="categorical") {
				html += `<b>`+(index+1)+`) `+element["name"]+`:</b><p>`;			
				html += `<select id="`+snake_case(element["name"])+`" oninput="run_model();">`;
					for (cat in element["categories"]) {
						html += `<option value="`+element["categories"][cat]+`"`;
						if (element["categories"][cat]==feature_values[element["name"]]) {
							html += ` selected`;
						}
						feature_values[element["name"]]
						html += `>`+element["categories"][cat]+`</option>`;
					}
				html += `<select>`;
			}
			html += `</p>
			</div>`;
	})

	html += `<!-- Check for change to notes and features and make sure folks know when they will be lost-->
			<p><b>NOTE (optional):</b></p>
			<p>
				<textarea id="note" style="width:100%;height:70px" oninput="tmp=JSON.parse(localStorage.feature_values);tmp['note']=this.value;localStorage.feature_values = JSON.stringify(tmp);">`+feature_values["note"]+`</textarea></p>
			<p>
				<a href="javascript:void('')" onClick="ground_truth();" class="button" style="margin-bottom: 20px;">Log Ground Truth</a>
			</p>
			<p>
				<sup>&dagger;</sup>
				Here's the regression behind this prediction:

				<div id="regression" class="regression">`

	model_html = ``
	if (model["type"]=="continuous") {
		model_html += `\\[y = B_0`;
	} else if (model["type"]=="categorical") {
		model_html += `\\[p(x) = {{1} \\over {1 + e^{-1(B_0`
	}	
	
	given_html = ``;
	if (model["type"]=="continuous") {
		given_html += `<li>\\(y\\) is the predicted value of your answer</li>`;
	} else if (model["type"]=="categorical") {
		given_html += `<li>\\(p(x)\\) is the probability the answer is <i>Yes</i></li>`;
	}
	//given_html += `<li>\\(B_0\\) is the <i>intercept</i> with value = `+Math.round(coefficients["intercept"]*100)/100+`</li>`;
	given_html += `<li>\\(B_0\\) is the <i>intercept</i> with value = `+coefficients["intercept"].toExponential(2)+`</li>`;

	var i = 1;
	features.forEach((element,index) => {
		if (element["type"]=="continuous") {
			variable_name = snake_case(element["name"]);
			given_html += `<li>\\(x_`+i+`\\) is <i>`+variable_name+`</i> measured in <i>`+element["units"]+`</i></li> `;
			//given_html += `<li>\\(B_`+i+`\\) is a coefficient with value <i>`+Math.round(coefficients[variable_name]*100)/100+`</i></li> `;
			given_html += `<li>\\(B_`+i+`\\) is a coefficient with value <i>`+coefficients[variable_name].toExponential(2)+`</i></li> `;
			model_html += `+ x_`+i+`*B_`+i;
			i += 1;
		} else if (element["type"]=="categorical") {
			for (cat in element["categories"]) {
				variable_name = snake_case(element["name"])+`-`+snake_case(element["categories"][cat]);
				given_html += `<li>\\(x_`+i+`\\) is the binary variable <i>`+variable_name+`</i>`;
				//given_html += `<li>\\(B_`+i+`\\) is a coefficient with value <i>`+Math.round(coefficients[variable_name]*100)/100+`</i></li> `;
				given_html += `<li>\\(B_`+i+`\\) is a coefficient with value <i>`+coefficients[variable_name].toExponential(2)+`</i></li> `;
				model_html += `+ x_`+i+`*B_`+i;
				i += 1;
			}
		}
	})

	if (model["type"]=="continuous") {
		model_html += `\\]`;
	} else if (model["type"]=="categorical") {
		model_html += `)}}}\\]`;		
	}	

	html += model_html + `</div>
				Where:
				<ul>`;
	html += given_html + `</ul>`;

	html_ondex = `<p>Curent Model Performance:<sup>*</sup></p>
			<ul>
				<li><a href="" target="_blank" class="body_links">R-squared</a> = 0.5</li>
				<li><a href="" target="_blank" class="body_links">accuracey</a> = 0.5</li>
			</ul>
			<sup>*</sup>Arrived at using k-folds 
		</p>
	</div>`;

	$('#features').empty();
	$('#features').append(html);
	try {
		MathJax.typeset();		
	} catch (error) {}

	var go = 1;
	if (changes==1) {
		let text = "You've made changes to your model without saving. Press OK to discard these changes and leave this page, or press Cancel to stay here.";
		if (confirm(text) != true) {
			go = 0;
		}
	}
	if (go==1) {
		changes = 0;
		//load_model();
		document.title = "Model: "+JSON.parse(localStorage.questions)[0]["question"];
		$('#about').hide();
		$('#tos').hide();
		$('#list_screen').hide();
		$('#new_model_screen').hide();
		$('#build_new').hide();
		$('#run').show();
		$('#ground_truth_screen').hide();	
		$('#training').hide();	
		$('#edit_screen').hide();
		localStorage.screen = "run";
		$('#models_link').show();
		$('#models_link').css('text-decoration', 'underline');
		$('#models_link').css('font-weight', 'normal');
		$('#new_mod').show();
		$('#upload_link').hide();
		$('#down_mod').hide();
		$('#run_mod').hide();
		$('#edit_mod').show();
		dark_mode();
		rethinkWindowSize();
		run_model();
	}
}

function ground_truth() {
	console.log("Show Log Ground Truth Screen")

	model = JSON.parse(localStorage.questions)[0]

	$('#ground_truth_screen').empty();
	html = "<h2>Log Ground Truth</h2>"
	html += "<p>Input and record the outcome/target value for the observations made on the last screen.</p><p>"

	if (model["type"]=="continuous"){
		html += `<input name="target" id="target" type="number" style="width:100%"/>`;
	} else if (model["type"]=="categorical"){
		html += `<select id="target" style="width:100%">`;
		for (x in model["target"]["possible_answers"]) {
			html += `<option>`+model["target"]["possible_answers"][x]+`</option>`;
		}
		html += `</select>`;
	}

	html += `</p><div class="button_container"><a href="javascript:void('')" onClick="save_obs();" class="button";">Save Observation</a>`
	html += `<a href="javascript:void('')" onClick="save_obs();save_and_train(0);" class="button">Save and Train</a>`
	html += `<a href="javascript:void('')" onClick="show_model();" class="button">Go Back W/O Saving</a></div>`

	$('#ground_truth_screen').append(html);

	setTimeout(function(){
    	$('#target').focus();
	});

	$('#about').hide();
	$('#tos').hide();
	$('#list_screen').hide();
	$('#new_model_screen').hide();
	$('#build_new').hide();
	$('#run').hide();
	$('#ground_truth_screen').show();	
	$('#training').hide();	
	$('#edit_screen').hide();
	localStorage.screen = "run";
	$('#models_link').hide();
	$('#models_link').css('text-decoration', 'underline');
	$('#models_link').css('font-weight', 'normal');
	$('#new_mod').hide();
	$('#upload_link').hide();
	$('#down_mod').hide();
	$('#run_mod').hide();
	$('#edit_mod').hide();

}

function save_obs(mode=1) {
	console.log("Save Observations")

	models = JSON.parse(localStorage.questions)
	model = models[0]
	headers = model["training"]["headers"]
	feature_values = JSON.parse(localStorage.feature_values);
	feature_values["recorded_on"] = new Date().toISOString().split('T')[0];
	feature_values["target"] = $('#target').val();

	row = []
	for (column in headers) {
		if (!headers[column].includes("-")) {
			row.push(feature_values[headers[column]])
		} else {
			if (headers[column].split("-")[1]==feature_values[headers[column].split("-")[0]]) {
				row.push(1)
			} else {
				row.push(0)
			}
		}
	}
	
	console.log("Saving ground truth...")
	console.log("Headers: "+headers.join(","))
	console.log("Values: ")
	console.log(row)

	model["training"]["observations"].push(row) 
	models[0] = model
	localStorage.questions = JSON.stringify(models);

	localStorage.removeItem('feature_values');
	mem_usage();

	if (mode==1) {
		load_model();
		show_model();
	}
}

function save_and_train(mode=0) {
	console.log("Save and Train")

	save_changes();

	$('#spinner_here').empty();
	if (localStorage.dark_mode==1) {
		tickcolor = '#ddd';		
	} else {
		tickcolor = '#000';		
	}
	start_spinner('spinner_here',tickcolor);

	$('#about').hide();
	$('#tos').hide();
	$('#list_screen').hide();
	$('#new_model_screen').hide();
	$('#build_new').hide();
	$('#run').hide();
	$('#ground_truth_screen').hide();	
	$('#training').show();	
	$('#edit_screen').hide();
	//localStorage.screen = "run";
	$('#models_link').hide();
	$('#models_link').css('text-decoration', 'underline');
	$('#models_link').css('font-weight', 'normal');
	$('#new_mod').hide();
	$('#upload_link').hide();
	$('#down_mod').hide();
	$('#run_mod').hide();
	$('#edit_mod').hide();

	passed = train_model();

	setTimeout(function(){
		if (!passed) {
			alert("Unable to build model! Any observations have been saved, but more data is needed. Add more and try again.")
		} else {
			save_changes();
		}
		load_model();
		if (mode==0) {
			show_model();
		} else {
			show_edit();
		}
	},1000);

}

function run_model(){
	console.log("Run/Update Model")
	
	feature_values = JSON.parse(localStorage.feature_values);
	model = JSON.parse(localStorage.questions)[0]
	equation = "";
	output = 0;
	coefficients = JSON.parse(localStorage.questions)[0]["coefficients"];
	for (const [key, value] of Object.entries(coefficients)) {
		if (key=="intercept") {
			//console.log(String(key)+value);
			output += value
			equation += String(value)
		} else if (!key.includes("-")) {
			//console.log(String(key)+($('#'+key).html())*value*1);
			output += ($('#'+key).html())*value*1
			equation += "("+String(($('#'+key).html()))+")("+String(value)+") + ";
			feature_values[key] = $('#'+key).html()*1
		} else {
			if ($('#'+key.split("-")[0]).val().toLowerCase()==key.split("-")[1].toLowerCase()) {
				output += 1*value
				equation += "(1)("+String(value)+") + "
			} else {
				output += 0
				equation += "(0)("+String(value)+") + "
			}
			feature_values[key.split("-")[0]] = $('#'+key.split("-")[0]).val();
		}
	}
	feature_values["note"] = $('#note').val();
	
	if (model["type"]=="continuous") {
		output = output;
		equation = String(output) + " = "  + equation;
	} else if (model["type"]=="categorical") {
		output = 100 / (1 + Math.E**(-1*output));
		equation = String(output) + " = (100)(1 /(1 + e^(-("  + equation + "))))";
	}	

	localStorage.feature_values = JSON.stringify(feature_values);

	//console.log(equation);
	output = Math.round(output*100)/100;
	if (model["type"]=="continuous") {
		$('#prediction_text').html(output+"<sup>&dagger;</sup>");
	} else if (model["type"]=="categorical") {
		$('#prediction_text').html("Yes ("+output+"%)<sup>&dagger;</sup>");
	}
}


function show_edit() {
	console.log("Show Edit Screen")

	document.title = "Edit: "+JSON.parse(localStorage.questions)[0]["question"];
	$('#about').hide();
	$('#tos').hide();
	$('#list_screen').hide();
	$('#new_model_screen').hide();
	$('#build_new').hide();
	$('#run').hide();
	$('#ground_truth_screen').hide();	
	$('#training').hide();	
	$('#edit_screen').show();
	localStorage.screen = "edit";
	$('#models_link').show();
	$('#models_link').css('text-decoration', 'underline');
	$('#models_link').css('font-weight', 'normal');
	$('#new_mod').show();
	$('#upload_link').show();
	$('#down_mod').show();
	$('#run_mod').show();
	$('#edit_mod').hide();
	dark_mode();
	window.scrollTo(0,0);
	$('#model_json').scrollTop(0); 

	check_wrap();
}


function load_model(n=0){
	console.log("Load Model")

	if (localStorage.questions!="[]"){
		var question_arr = JSON.parse(localStorage.questions)
		question_arr.unshift(question_arr.splice(n, 1)[0]);
		localStorage.questions = JSON.stringify(question_arr)
		question = question_arr[0]["question"]
		$('#model_json').val(JSON.stringify(question_arr[0], null, 2))
		//document.title = question;
		$('#question_text').html(question);
		$('#prediction_text').html("--<sup>&dagger;</sup>");
		if (question_arr[0]["trained_on"]) {
			$('#n_entires').html(question_arr[0]["trained_on"]);
		} else {
			$('#n_entires').html('<i>n</i>');
		}
		$('#features_wrapper').css('top',($('#prediction').height()+40)+'px'); 
		$('#features_wrapper').scrollTop(0);
	}
}

function load_lib_model(n=0){
	console.log("Add Library Model to My Models")

	var question_arr = JSON.parse(localStorage.questions)
	question_arr.unshift(library[n]);
	//question_arr.unshift(question_arr.splice(n, 1)[0]);
	localStorage.questions = JSON.stringify(question_arr)
	question = question_arr[0]["question"]
	$('#model_json').val(JSON.stringify(question_arr[0], null, 2))
	//document.title = question;
	$('#question_text').html(question);
	$('#prediction_text').html("--<sup>&dagger;</sup>");
	if (question_arr[0]["trained_on"]) {
		$('#n_entires').html(question_arr[0]["trained_on"]);
	} else {
		$('#n_entires').html('<i>n</i>');
	}
	$('#features_wrapper').css('top',($('#prediction').height()+40)+'px'); 
	$('#features_wrapper').scrollTop(0);
}

function snake_case(text){
	text = text.replace(/[^a-zA-Z]/g,"_");
	text = text.replace(/_+/g,"_");
	text = text.replace(/^_+|_+$/g, '');
	return text
}

function upload_file() {
	console.log("Upload File")
    $("#upload:hidden").trigger('click');
}

function format_check(json){
	console.log("Check JSON format")
	var output;
	if ((json["question"]) && 
		(json["type"]) && 
		(Object.keys(json["features"]).length>0) && 
		(Object.keys(json["coefficients"]).length>1) && 
		(!Number.isNaN(json["coefficients"]["intercept"]))) {
		output = ""
	} else {
		output = "Please check your code, edit, and try again.";	
	}
	return output
}

function mem_limit() {
	console.log("Find Memory Limit")
	if (localStorage && !localStorage.getItem('mem_limit')) {
		var i = 0;
		try {
			// Test up to 10 MB
			for (i = 250; i <= 10000; i += 250) {
				localStorage.setItem('mem_test', new Array((i * 1024) + 1).join('a'));
			}
		} catch (e) {
			localStorage.removeItem('mem_test');
			localStorage.setItem('mem_limit', i - 250);            
		}
		return true
	} else {
		return false
	}
}

function mem_usage() {
	new_check = mem_limit();
	if (new_check) {
		console.log("MEMORY REPORT");
	}
	var _lsTotal = 0,
    _xLen, _x;
	for (_x in localStorage) {
		if (!localStorage.hasOwnProperty(_x)) {
			continue;
		}
		_xLen = ((localStorage[_x].length + _x.length) * 2);
		_lsTotal += _xLen;
		if (new_check) {
			console.log(" - " + _x.substr(0, 50) + " = " + (_xLen / 1024).toFixed(2) + " KB")
		}
	};
	kbs = (_lsTotal / 1024).toFixed(2)
	percentage = (_lsTotal / 1024).toFixed(2)/localStorage.mem_limit	
	console.log("Memory Check: " + Math.round(percentage*10000)/100 + "% (" + kbs + "KB/" + localStorage.mem_limit + "KB)");

	if (percentage>=0.4) {
		alert('Your model library is taking up '+ kbs + " KB. Consider saving some of your data to file(s) and deleting them from here to free up space.")
	}
}

function arr2csv(){
	console.log("Convert Array to CSV")
	csv = JSON.parse(localStorage.questions)[0]["training"]["observations"] 
	csv.unshift(JSON.parse(localStorage.questions)[0]["training"]["headers"])

	csv_text = "";

	for(var i=0; i<csv.length; i++){
		row = csv[i]
		for(var j=0; j<row.length; j++){
			if (j>0) {
				csv_text += ","
			}
    		csv_text += JSON.stringify(row[j]);
		}
		csv_text += "\n";
	}

	filename = snake_case(JSON.parse(localStorage.questions)[0]["question"]).slice(0,25);
	saveTextAsFile(csv_text,"observations-"+filename+".csv");
}

//===========================================
// Data handling
//===========================================
// h/t http://answers.splunk.com/answers/125819/fill-textarea-from-a-file.html

var control = document.getElementById("upload");
control.addEventListener("change", function(event){
	if (window.File && window.FileReader && window.FileList && window.Blob) {
		var reader = new FileReader();
			reader.onload = function(event){
				this_model = event.target.result;
				try {
					error_msg = format_check(JSON.parse(this_model));					
				} catch (error) {
					error_msg = "Error loading file.";
				}
				if (error_msg.length>0) {
            		alert("There is a problem with this file's format. " + error_msg);
        		} else {
					if (localStorage.screen=="edit"){
						let text = "Loading this file will overwrite the current model.";
  						if (confirm(text) == true) {
							q_arr = JSON.parse(localStorage.questions);
							q_arr[0] = JSON.parse(this_model)
							localStorage.questions = JSON.stringify(q_arr);
							load_model();
							show_edit();
						}
					} else {
						localStorage.questions = JSON.stringify([JSON.parse(this_model)].concat(JSON.parse(localStorage.questions)));
						show_list();
					}
				}

			};
			reader.onerror = function(event){
				console.error("File could not be read! Code " + event.target.error.code);
			};
			//console.log("Filename: " + control.files[0].name);
			reader.readAsText(control.files[0]);
	} else {
		alert('This feature is not supported by your browser.');
	}
}, false);

//===========================================
// Custom keypress events
//===========================================

$('#reply').keypress(function(e){
	if(e.keyCode == 13 && !e.shiftKey) {
		e.preventDefault();
		answer_button();
	}
});

function delete_mod(n) {
  console.log("Delete Model")
  let text = "Press OK to delete this model and its data or Cancel to do nothing.";
  if (confirm(text) == true) {
	localStorage.removeItem("feature_values"); 
	var question_arr =  JSON.parse(localStorage.questions)
	var tmp = question_arr.shift();
	localStorage.questions = JSON.stringify(question_arr);
	show_list();
  }
}

function check_wrap(){
	console.log("Check Word Wrap")
	if (localStorage.word_wrap == 1) {
		$( "#wrap" ).prop( "checked", true );
		document.getElementById('model_json').wrap = "soft";
	} else {
		document.getElementById('model_json').wrap = "off";	
	}
}

// toggle wrap 
function toggle_wrap(value) {
	console.log("Toggle Word Warp")
	if (document.getElementById('wrap').checked) {
		document.getElementById('model_json').wrap = "soft";
		localStorage.word_wrap = 1;
	} else {
		document.getElementById('model_json').wrap = "off";	
		localStorage.word_wrap = 0;
	}
	//document.getElementById('model_json').value = document.getElementById('model_json').value
}	

// https://stackoverflow.com/a/68259380
//var editor = CodeMirror.fromTextArea(document.getElementById('model_json'), {
//    lineNumbers: true,
    //mode: 'text/javascript',
//    matchBrackets: true,
//});

function load_page() {
	console.log("Load Screen")
	load_model();
	
	if (localStorage.screen=="list") {
		show_list();
	} else if (localStorage.screen=="lib") {
		show_lib();
	} else if (localStorage.screen=="new") {
		make_new();
	} else if (localStorage.screen=="run") {
		show_model();
	} else if (localStorage.screen=="edit") {
		show_edit();
	} else {
		show_about();
	}

	setTimeout(function(){
			mem_usage();
	});	
	//start_spinner('loading_box');
	//passcheck();
}

window.onpaint = load_page();

var changes = 0;
$(window).bind('beforeunload', function(){
  if (changes==1) {
    return 'Are you sure you want to leave? Changes will not be saved.';
  } else {
	return undefined
  }
});

function save_changes() {
	console.log("Save Model")
	try {
		var question_arr = JSON.parse(localStorage.questions);
		active_json = JSON.parse($('#model_json').val());
		error_msg = format_check(active_json);
		if (error_msg.length==0) {
			question_arr[0] = active_json;
			localStorage.questions = JSON.stringify(question_arr);
			changes = 0;
		} else {
			alert("There was an issue with your json format. No changes have been saved. " + error_msg)
		}		
	} catch (error) {
		alert("There was an issue with your json format. No changes have been saved. ")
	}
}

function wrangle() {
	console.log("Wrangle Observation Data")
	data = JSON.parse(localStorage.questions)[0]["training"]["observations"] 
	//data.unshift(JSON.parse(localStorage.questions)[0]["training"]["headers"])
	var removeIndexes = [0,data[0].length-1]
	data = data.map(v => v.filter((_, i) => !removeIndexes.includes(i)))
	for(var i=0; i<data.length; i++){
		row = data[i]
		j = row.length-1;
		if (row[j].toLowerCase()=="yes") {
			data[i][j] = 1;
		} else if (row[j].toLowerCase()=="no") {
			data[i][j] = 0;
		}
	}
	return data
}


function train_model(mode=0){
	console.log("Train Model")

	models = JSON.parse(localStorage.questions)
	this_model = models[0]

	data = wrangle();
	
	console.log("Type: "+this_model["type"])
	console.log(data)

	// https://github.com/chen0040/js-regression

	if (this_model["type"]=="continuous") {
		console.log("Linear Regressions")
		// === Create the linear regression === //
		var regression = new jsregression.LinearRegression({
			alpha: 0.00000001, // 
			iterations: 3000,
			lambda: 0.0,
			trace: false
		});

		// === Train the linear regression === //
		var r_model = regression.fit(data);
	} else if (this_model["type"]=="categorical") {
		console.log("Logistic Regressions")
		// === Create the logistic regression === //
		var logistic = new jsregression.LogisticRegression({
			alpha: 0.00000001,
			iterations: 3000,
			lambda: 0.0
		});

		// === Train the logistic regression === //
		var r_model = logistic.fit(data);		
	}

	if (r_model["theta"][0]) {
		headers = [JSON.parse(localStorage.questions)[0]["training"]["headers"]]
		var removeIndexes = [0,headers[0].length-2,headers[0].length-1]
		headers = headers.map(v => v.filter((_, i) => !removeIndexes.includes(i)))
		
		//headers[0].unshift("intercept")
		headers[0].push("intercept")
		
		console.log(data.length);
		coefficients = {}
		for (feature in headers[0]){
			coefficients[headers[0][feature]] = r_model["theta"][feature];
		}

		models[0]["trained_on"] = data.length
		models[0]["coefficients"] = coefficients

		$('#model_json').val(JSON.stringify(models[0], null, 2));
		localStorage.question = JSON.stringify(models);

		return true
	} else {
		return false
	}

}


</script>

<!---
	// Functional
	- make equations render dynamic

	X get load to work
	X reorder lists on model load
	X get delete to work
		X what if list is empty (deleted everything) check behavior
	X Save changes
	X prompt to save before leaving edit page if change
	X add from library
	X Check for valid format (add to save and load)
	X load into existing or add new
	X add save check to upload
	X figure out what you are downloading when in edit (saved or written)
	X dynamicly build run model page from json
	X save feature values to storage before ground truth (save state)
	X log ground truth functionality (upload status)
	X add size limit warnings
	X [NEW SCREEN] terms
	- [NEW SCREEN] build new page functionality
	X add training feature

	- set increments on ranges 
	- add interaction terms
	- add exclude terms list

	// Cosmetic
	X stop features jump on prediction recaluclate
	X get title to change back to My Models
	X recalculate stuff on rotate
	X remove or recolor top border line from dark modes
	X proper padding on all pages footer
	X fix links in dark mode
	X format caption text
	X scroll to top for all screens on change
	- Word wrap

	// Writing
	- write feedback form
	- write documenation page
	- write terms page

	// DevOps
	- get domain

	//Post MVP
	- search for library and modles lists

	Some predictions to play with:
	- How long will my run be?
	- Will I have a good sleep?
	- hours (cost) on case (time to do X)
	- value of case (win)
	- net value of case (win-cost)
	- outcome of case
	- risk score
	- expected value calculations 
--->

</HTML>